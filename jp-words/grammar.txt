### **Grammar Rule Schema**

Each entry in the `GRAMMAR_RULES` array is an object representing a single grammar point.

```typescript
interface GrammarRule {
  /**
   * Unique identifier for the grammar rule.
   * Format: Kebab-case string.
   * Example: "te-iru", "ni-suru", "koto-ga-dekiru"
   */
  id: string;

  /**
   * Human-readable title of the grammar point.
   * Format: Japanese grammar structure, often starting with ～.
   * Example: "～ている", "～ないで／ずに"
   */
  title: string;

  /**
   * A list of token sequences that define the grammar pattern.
   * If ANY of these sequences match the input text, the rule is triggered.
   */
  patterns: TokenConstraint[][];

  /**
   * A list of example sentences that should match this rule.
   * Used for verification and testing.
   */
  tests: string[];
}
```

---

### **Token Constraint Schema**

Each array inside `patterns` represents a sequence of tokens (words/morphemes) that must appear in order. Each object in that sequence describes the constraints for a single token. All properties are optional; if multiple properties are provided, **all must match** for that token.

```typescript
interface TokenConstraint {
  /**
   * The exact surface form of the token as it appears in the text.
   * Use this for fixed particles or specific conjugations.
   * Example: "て", "ない", "ます"
   */
  surface?: string;

  /**
   * The dictionary (base) form of the word.
   * Use this to match a verb/adjective regardless of its conjugation.
   * Example: "いる" (matches いる, いない, います), "食べる"
   */
  baseForm?: string;

  /**
   * The Part of Speech (POS) of the token.
   * Matches the Sudachi POS tag system.
   * Example: "動詞" (Verb), "助動詞" (Auxiliary Verb)
   */
  pos?: string;

  /**
   * The conjugation form of the token.
   * Use this to target specific grammatical forms (e.g., Te-form base).
   * Example: "連用形" (Continuative/Stem form), "未然形" (Imperfective/Negative base)
   */
  conjugation?: string;

  /**
   * Matches if the surface form ends with this string.
   * Useful for compounds or polite forms like "〜ましょう".
   * Example: "方" (matches "話し方", "書き方")
   */
  surfaceEndsWith?: string;
}
```

You can also add a wildcard by adding an empty object `{}` into the pattern array, e.g. 

```
// "と～と、どちらが"
[
  { surface: "と", pos: "助詞" },
  {},
  { surface: "と", pos: "助詞" },
  { baseForm: "どちら" },
  { surface: "が" },
]
```

---

### **Reference Values**

These are the specific values observed in the current dataset. You should use these values to ensure compatibility with the analyzer.

#### **1. `pos` (Part of Speech)**

- `動詞` (Verb)
- `助動詞` (Auxiliary Verb)
- `助詞` (Particle)
- `名詞` (Noun)
- `形容詞` (Adjective)
- `副詞` (Adverb)
- `形状詞` (Adjectival Noun / Na-adjective)
- `代名詞` (Pronoun)
- `接尾辞` (Suffix)

#### **2. `conjugation` (Conjugation Form)**

- `連用形` (Ren'yōkei - Continuative form / Stem / Te-form base)
  - _Used in patterns like:_ `～ている` (Te-form), `～方` (Stem + kata), `～にくい` (Stem + nikui)
- `未然形` (Mizenkei - Imperfective form / Nai-form base)
  - _Used in:_ Negatives (`ない`), Causatives (`せる/させる`), Passives (`れる/られる`)
- `終止形` (Shūshikei - Terminal form / Dictionary form)
  - _Used in:_ `～と` (Conditional), `～なさい` (Imperative base)
- `命令形` (Meireikei - Imperative form)
  - _Used in:_ Commands (`～なさい`)
- `意志推量形` (Volitional/Presumptive form)
  - _Used in:_ `～ようと思う`

---

### **Example Rules**

#### **Example 1: Verb Te-form + iru (～ている)**

Matches specific surface forms ("て" or "で") followed by the base form "いる".

```javascript
{
  id: "te-iru",
  title: "～ている",
  patterns: [
    [
      { pos: "動詞" },       // Any verb
      { surface: "て" },     // followed by "te"
      { baseForm: "いる" }   // followed by "iru" (dictionary form)
    ],
    [
      { pos: "動詞" },
      { surface: "で" },     // or "de" (for verbs ending in bu/mu/nu)
      { baseForm: "いる" }
    ]
  ],
  tests: ["ご飯を食べている", "死んでいる"]
}
```

#### **Example 2: Stem + kata (～方)**

Matches a verb in `連用形` (stem form) followed by the suffix "方".

```javascript
{
  id: "kata-method",
  title: "～方",
  patterns: [
    [
      { pos: "動詞", conjugation: "連用形" }, // Verb stem (e.g., "話し")
      { surface: "方", pos: "接尾辞" }        // Suffix "kata"
    ]
  ],
  tests: ["話し方が丁寧だ"]
}
```
